{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getOrderHash = exports.hashDomain = exports.hashOrder = exports.hashParty = exports.PARTY_TYPEHASH = exports.ORDER_TYPEHASH = exports.LIGHT_EIP712_DOMAIN_TYPEHASH = exports.EIP712_DOMAIN_TYPEHASH = void 0;\n\nvar util = __importStar(require(\"ethereumjs-util\"));\n\nvar ethers_1 = require(\"ethers\");\n\nvar constants_1 = require(\"@airswap/constants\");\n\nvar types_1 = require(\"@airswap/types\");\n\nfunction stringify(types, primaryType) {\n  var str = primaryType + \"(\";\n  var keys = Object.keys(types[primaryType]);\n\n  for (var i = 0; i < keys.length; i++) {\n    str += types[primaryType][i].type + \" \" + types[primaryType][i].name;\n\n    if (i !== keys.length - 1) {\n      str += ',';\n    }\n  }\n\n  return str + \")\";\n}\n\nexports.EIP712_DOMAIN_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'EIP712Domain'));\nexports.LIGHT_EIP712_DOMAIN_TYPEHASH = util.keccak256(stringify(types_1.EIP712Light, 'EIP712Domain'));\nexports.ORDER_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'Order') + stringify(types_1.EIP712, 'Party'));\nexports.PARTY_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'Party'));\n\nfunction hashParty(party) {\n  return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'bytes4', 'address', 'address', 'uint256', 'uint256'], [exports.PARTY_TYPEHASH, party.kind, party.wallet, party.token, party.amount, party.id]));\n}\n\nexports.hashParty = hashParty;\n\nfunction hashOrder(order) {\n  return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'uint256', 'uint256', 'bytes32', 'bytes32', 'bytes32'], [exports.ORDER_TYPEHASH, order.nonce, order.expiry, hashParty(order.signer), hashParty(order.sender), hashParty(order.affiliate)]));\n}\n\nexports.hashOrder = hashOrder;\n\nfunction hashDomain(swapContract) {\n  return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'bytes32', 'bytes32', 'address'], [exports.EIP712_DOMAIN_TYPEHASH, util.keccak256(constants_1.DOMAIN_NAME), util.keccak256(constants_1.DOMAIN_VERSION), swapContract]));\n}\n\nexports.hashDomain = hashDomain;\n\nfunction getOrderHash(order, swapContract) {\n  return util.keccak256(Buffer.concat([Buffer.from('1901', 'hex'), hashDomain(swapContract), hashOrder(order)]));\n}\n\nexports.getOrderHash = getOrderHash;","map":{"version":3,"sources":["../../src/hashes.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getOrderHash = exports.hashDomain = exports.hashOrder = exports.hashParty = exports.PARTY_TYPEHASH = exports.ORDER_TYPEHASH = exports.LIGHT_EIP712_DOMAIN_TYPEHASH = exports.EIP712_DOMAIN_TYPEHASH = void 0;\nvar util = __importStar(require(\"ethereumjs-util\"));\nvar ethers_1 = require(\"ethers\");\nvar constants_1 = require(\"@airswap/constants\");\nvar types_1 = require(\"@airswap/types\");\nfunction stringify(types, primaryType) {\n    var str = primaryType + \"(\";\n    var keys = Object.keys(types[primaryType]);\n    for (var i = 0; i < keys.length; i++) {\n        str += types[primaryType][i].type + \" \" + types[primaryType][i].name;\n        if (i !== keys.length - 1) {\n            str += ',';\n        }\n    }\n    return str + \")\";\n}\nexports.EIP712_DOMAIN_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'EIP712Domain'));\nexports.LIGHT_EIP712_DOMAIN_TYPEHASH = util.keccak256(stringify(types_1.EIP712Light, 'EIP712Domain'));\nexports.ORDER_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'Order') + stringify(types_1.EIP712, 'Party'));\nexports.PARTY_TYPEHASH = util.keccak256(stringify(types_1.EIP712, 'Party'));\nfunction hashParty(party) {\n    return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'bytes4', 'address', 'address', 'uint256', 'uint256'], [\n        exports.PARTY_TYPEHASH,\n        party.kind,\n        party.wallet,\n        party.token,\n        party.amount,\n        party.id,\n    ]));\n}\nexports.hashParty = hashParty;\nfunction hashOrder(order) {\n    return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'uint256', 'uint256', 'bytes32', 'bytes32', 'bytes32'], [\n        exports.ORDER_TYPEHASH,\n        order.nonce,\n        order.expiry,\n        hashParty(order.signer),\n        hashParty(order.sender),\n        hashParty(order.affiliate),\n    ]));\n}\nexports.hashOrder = hashOrder;\nfunction hashDomain(swapContract) {\n    return util.keccak256(ethers_1.ethers.utils.defaultAbiCoder.encode(['bytes32', 'bytes32', 'bytes32', 'address'], [\n        exports.EIP712_DOMAIN_TYPEHASH,\n        util.keccak256(constants_1.DOMAIN_NAME),\n        util.keccak256(constants_1.DOMAIN_VERSION),\n        swapContract,\n    ]));\n}\nexports.hashDomain = hashDomain;\nfunction getOrderHash(order, swapContract) {\n    return util.keccak256(Buffer.concat([\n        Buffer.from('1901', 'hex'),\n        hashDomain(swapContract),\n        hashOrder(order),\n    ]));\n}\nexports.getOrderHash = getOrderHash;\n//# sourceMappingURL=hashes.js.map"]},"metadata":{},"sourceType":"script"}