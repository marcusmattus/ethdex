{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.orderPropsToStrings = exports.lightOrderToParams = exports.getSignerFromLightSignature = exports.createLightSignature = exports.createLightOrder = exports.isValidLightOrder = exports.numberToBytes32 = void 0;\n\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\n\nvar sigUtil = __importStar(require(\"eth-sig-util\"));\n\nvar ethers_1 = require(\"ethers\");\n\nvar constants_1 = require(\"@airswap/constants\");\n\nvar types_1 = require(\"@airswap/types\");\n\nfunction numberToBytes32(number) {\n  var hexString = number.toString(16);\n  return \"0x\" + hexString.padStart(64, '0');\n}\n\nexports.numberToBytes32 = numberToBytes32;\n\nfunction isValidLightOrder(order) {\n  return order && 'nonce' in order && 'expiry' in order && 'signerWallet' in order && 'signerToken' in order && 'signerAmount' in order && 'senderToken' in order && 'senderAmount' in order && 'r' in order && 's' in order && 'v' in order;\n}\n\nexports.isValidLightOrder = isValidLightOrder; // eslint-disable-next-line  @typescript-eslint/explicit-module-boundary-types\n\nfunction createLightOrder(_a) {\n  var _b = _a.expiry,\n      expiry = _b === void 0 ? Math.round(Date.now() / 1000 + constants_1.SECONDS_IN_DAY).toString() : _b,\n      _c = _a.nonce,\n      nonce = _c === void 0 ? Date.now().toString() : _c,\n      _d = _a.signerWallet,\n      signerWallet = _d === void 0 ? constants_1.ADDRESS_ZERO : _d,\n      _e = _a.signerToken,\n      signerToken = _e === void 0 ? constants_1.ADDRESS_ZERO : _e,\n      _f = _a.signerAmount,\n      signerAmount = _f === void 0 ? '0' : _f,\n      _g = _a.protocolFee,\n      protocolFee = _g === void 0 ? '0' : _g,\n      _h = _a.senderWallet,\n      senderWallet = _h === void 0 ? constants_1.ADDRESS_ZERO : _h,\n      _j = _a.senderToken,\n      senderToken = _j === void 0 ? constants_1.ADDRESS_ZERO : _j,\n      _k = _a.senderAmount,\n      senderAmount = _k === void 0 ? '0' : _k;\n  return {\n    expiry: String(expiry),\n    nonce: String(nonce),\n    signerWallet: signerWallet,\n    signerToken: signerToken,\n    signerAmount: String(signerAmount),\n    protocolFee: String(protocolFee),\n    senderWallet: senderWallet,\n    senderToken: senderToken,\n    senderAmount: String(senderAmount)\n  };\n}\n\nexports.createLightOrder = createLightOrder;\n\nfunction createLightSignature(unsignedOrder, signer, swapContract, chainId) {\n  return __awaiter(this, void 0, void 0, function () {\n    var sig, _a, r, s, v;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (!(typeof signer === 'string')) return [3\n          /*break*/\n          , 1];\n          sig = sigUtil.signTypedData_v4(ethUtil.toBuffer(signer), {\n            data: {\n              types: types_1.EIP712Light,\n              domain: {\n                name: constants_1.LIGHT_DOMAIN_NAME,\n                version: constants_1.LIGHT_DOMAIN_VERSION,\n                chainId: chainId,\n                verifyingContract: swapContract\n              },\n              primaryType: 'LightOrder',\n              message: unsignedOrder\n            }\n          });\n          return [3\n          /*break*/\n          , 3];\n\n        case 1:\n          return [4\n          /*yield*/\n          , signer._signTypedData({\n            name: constants_1.LIGHT_DOMAIN_NAME,\n            version: constants_1.LIGHT_DOMAIN_VERSION,\n            chainId: chainId,\n            verifyingContract: swapContract\n          }, {\n            LightOrder: types_1.EIP712Light.LightOrder\n          }, unsignedOrder)];\n\n        case 2:\n          sig = _b.sent();\n          _b.label = 3;\n\n        case 3:\n          _a = ethers_1.ethers.utils.splitSignature(sig), r = _a.r, s = _a.s, v = _a.v;\n          return [2\n          /*return*/\n          , {\n            r: r,\n            s: s,\n            v: String(v)\n          }];\n      }\n    });\n  });\n}\n\nexports.createLightSignature = createLightSignature;\n\nfunction getSignerFromLightSignature(order, swapContract, chainId, v, r, s) {\n  var sig = \"\" + r + s.slice(2) + ethers_1.ethers.BigNumber.from(v).toHexString().slice(2);\n  return sigUtil.recoverTypedSignature_v4({\n    data: {\n      types: types_1.EIP712Light,\n      domain: {\n        name: constants_1.LIGHT_DOMAIN_NAME,\n        version: constants_1.LIGHT_DOMAIN_VERSION,\n        chainId: chainId,\n        verifyingContract: swapContract\n      },\n      primaryType: 'LightOrder',\n      message: order\n    },\n    sig: sig\n  });\n}\n\nexports.getSignerFromLightSignature = getSignerFromLightSignature;\n\nfunction lightOrderToParams(order) {\n  return [order.nonce, order.expiry, order.signerWallet, order.signerToken, order.signerAmount, order.senderToken, order.senderAmount, order.v, order.r, order.s];\n}\n\nexports.lightOrderToParams = lightOrderToParams;\n\nfunction orderPropsToStrings(obj) {\n  return {\n    nonce: String(obj.nonce),\n    expiry: String(obj.expiry),\n    signerWallet: String(obj.signerWallet),\n    signerToken: String(obj.signerToken),\n    signerAmount: String(obj.signerAmount),\n    senderToken: String(obj.senderToken),\n    senderAmount: String(obj.senderAmount),\n    v: String(obj.v),\n    r: String(obj.r),\n    s: String(obj.s)\n  };\n}\n\nexports.orderPropsToStrings = orderPropsToStrings;","map":{"version":3,"sources":["../../src/orders.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.orderPropsToStrings = exports.lightOrderToParams = exports.getSignerFromLightSignature = exports.createLightSignature = exports.createLightOrder = exports.isValidLightOrder = exports.numberToBytes32 = void 0;\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\nvar sigUtil = __importStar(require(\"eth-sig-util\"));\nvar ethers_1 = require(\"ethers\");\nvar constants_1 = require(\"@airswap/constants\");\nvar types_1 = require(\"@airswap/types\");\nfunction numberToBytes32(number) {\n    var hexString = number.toString(16);\n    return \"0x\" + hexString.padStart(64, '0');\n}\nexports.numberToBytes32 = numberToBytes32;\nfunction isValidLightOrder(order) {\n    return (order &&\n        'nonce' in order &&\n        'expiry' in order &&\n        'signerWallet' in order &&\n        'signerToken' in order &&\n        'signerAmount' in order &&\n        'senderToken' in order &&\n        'senderAmount' in order &&\n        'r' in order &&\n        's' in order &&\n        'v' in order);\n}\nexports.isValidLightOrder = isValidLightOrder;\n// eslint-disable-next-line  @typescript-eslint/explicit-module-boundary-types\nfunction createLightOrder(_a) {\n    var _b = _a.expiry, expiry = _b === void 0 ? Math.round(Date.now() / 1000 + constants_1.SECONDS_IN_DAY).toString() : _b, _c = _a.nonce, nonce = _c === void 0 ? Date.now().toString() : _c, _d = _a.signerWallet, signerWallet = _d === void 0 ? constants_1.ADDRESS_ZERO : _d, _e = _a.signerToken, signerToken = _e === void 0 ? constants_1.ADDRESS_ZERO : _e, _f = _a.signerAmount, signerAmount = _f === void 0 ? '0' : _f, _g = _a.protocolFee, protocolFee = _g === void 0 ? '0' : _g, _h = _a.senderWallet, senderWallet = _h === void 0 ? constants_1.ADDRESS_ZERO : _h, _j = _a.senderToken, senderToken = _j === void 0 ? constants_1.ADDRESS_ZERO : _j, _k = _a.senderAmount, senderAmount = _k === void 0 ? '0' : _k;\n    return {\n        expiry: String(expiry),\n        nonce: String(nonce),\n        signerWallet: signerWallet,\n        signerToken: signerToken,\n        signerAmount: String(signerAmount),\n        protocolFee: String(protocolFee),\n        senderWallet: senderWallet,\n        senderToken: senderToken,\n        senderAmount: String(senderAmount),\n    };\n}\nexports.createLightOrder = createLightOrder;\nfunction createLightSignature(unsignedOrder, signer, swapContract, chainId) {\n    return __awaiter(this, void 0, void 0, function () {\n        var sig, _a, r, s, v;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    if (!(typeof signer === 'string')) return [3 /*break*/, 1];\n                    sig = sigUtil.signTypedData_v4(ethUtil.toBuffer(signer), {\n                        data: {\n                            types: types_1.EIP712Light,\n                            domain: {\n                                name: constants_1.LIGHT_DOMAIN_NAME,\n                                version: constants_1.LIGHT_DOMAIN_VERSION,\n                                chainId: chainId,\n                                verifyingContract: swapContract,\n                            },\n                            primaryType: 'LightOrder',\n                            message: unsignedOrder,\n                        },\n                    });\n                    return [3 /*break*/, 3];\n                case 1: return [4 /*yield*/, signer._signTypedData({\n                        name: constants_1.LIGHT_DOMAIN_NAME,\n                        version: constants_1.LIGHT_DOMAIN_VERSION,\n                        chainId: chainId,\n                        verifyingContract: swapContract,\n                    }, { LightOrder: types_1.EIP712Light.LightOrder }, unsignedOrder)];\n                case 2:\n                    sig = _b.sent();\n                    _b.label = 3;\n                case 3:\n                    _a = ethers_1.ethers.utils.splitSignature(sig), r = _a.r, s = _a.s, v = _a.v;\n                    return [2 /*return*/, { r: r, s: s, v: String(v) }];\n            }\n        });\n    });\n}\nexports.createLightSignature = createLightSignature;\nfunction getSignerFromLightSignature(order, swapContract, chainId, v, r, s) {\n    var sig = \"\" + r + s.slice(2) + ethers_1.ethers.BigNumber.from(v)\n        .toHexString()\n        .slice(2);\n    return sigUtil.recoverTypedSignature_v4({\n        data: {\n            types: types_1.EIP712Light,\n            domain: {\n                name: constants_1.LIGHT_DOMAIN_NAME,\n                version: constants_1.LIGHT_DOMAIN_VERSION,\n                chainId: chainId,\n                verifyingContract: swapContract,\n            },\n            primaryType: 'LightOrder',\n            message: order,\n        },\n        sig: sig,\n    });\n}\nexports.getSignerFromLightSignature = getSignerFromLightSignature;\nfunction lightOrderToParams(order) {\n    return [\n        order.nonce,\n        order.expiry,\n        order.signerWallet,\n        order.signerToken,\n        order.signerAmount,\n        order.senderToken,\n        order.senderAmount,\n        order.v,\n        order.r,\n        order.s,\n    ];\n}\nexports.lightOrderToParams = lightOrderToParams;\nfunction orderPropsToStrings(obj) {\n    return {\n        nonce: String(obj.nonce),\n        expiry: String(obj.expiry),\n        signerWallet: String(obj.signerWallet),\n        signerToken: String(obj.signerToken),\n        signerAmount: String(obj.signerAmount),\n        senderToken: String(obj.senderToken),\n        senderAmount: String(obj.senderAmount),\n        v: String(obj.v),\n        r: String(obj.r),\n        s: String(obj.s),\n    };\n}\nexports.orderPropsToStrings = orderPropsToStrings;\n//# sourceMappingURL=orders.js.map"]},"metadata":{},"sourceType":"script"}