{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __exportStar = this && this.__exportStar || function (m, exports) {\n  for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.lowerCaseAddresses = exports.flattenObject = exports.getEtherscanURL = exports.parseUrl = exports.getTimestamp = exports.toAtomicString = exports.toDecimalString = exports.getBestByHighestSenderAmount = exports.getBestByHighestSignerAmount = exports.getBestByLowestSignerAmount = exports.getBestByLowestSenderAmount = exports.calculateCostFromLevels = exports.calculateCost = void 0;\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\nvar ethers_1 = require(\"ethers\");\n\nvar url = __importStar(require(\"url\"));\n\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\n\nvar constants_1 = require(\"@airswap/constants\");\n\n__exportStar(require(\"./src/hashes\"), exports);\n\n__exportStar(require(\"./src/orders\"), exports);\n\n__exportStar(require(\"./src/quotes\"), exports);\n\nfunction calculateCost(amount, pricing) {\n  // TODO: Formula support\n  if (typeof pricing !== 'string') {\n    return calculateCostFromLevels(amount, pricing);\n  }\n\n  return null;\n}\n\nexports.calculateCost = calculateCost;\n\nfunction calculateCostFromLevels(amount, levels) {\n  var totalAmount = new bignumber_js_1.default(amount);\n  var totalAvailable = new bignumber_js_1.default(levels[levels.length - 1][0]);\n  var totalCost = new bignumber_js_1.default(0);\n  var previousLevel = new bignumber_js_1.default(0);\n\n  if (totalAmount.gt(totalAvailable)) {\n    throw new Error(\"Requested amount (\" + totalAmount.toFixed() + \") exceeds maximum available (\" + totalAvailable.toFixed() + \").\");\n  } // Steps through levels and multiplies each incremental amount by the level price\n  // Levels takes the form of [[ level, price ], ... ] as in [[ '100', '0.5' ], ... ]\n\n\n  for (var i = 0; i < levels.length; i++) {\n    var incrementalAmount = void 0;\n\n    if (totalAmount.gt(new bignumber_js_1.default(levels[i][0]))) {\n      incrementalAmount = new bignumber_js_1.default(levels[i][0]).minus(previousLevel);\n    } else {\n      incrementalAmount = new bignumber_js_1.default(totalAmount).minus(previousLevel);\n    }\n\n    totalCost = totalCost.plus(new bignumber_js_1.default(incrementalAmount).multipliedBy(levels[i][1]));\n    previousLevel = new bignumber_js_1.default(levels[i][0]);\n    if (totalAmount.lt(previousLevel)) break;\n  }\n\n  return totalCost.decimalPlaces(6).toFixed();\n}\n\nexports.calculateCostFromLevels = calculateCostFromLevels;\n\nfunction getLowest(objects, key) {\n  var best;\n  var bestAmount;\n  var amount;\n\n  for (var _i = 0, objects_1 = objects; _i < objects_1.length; _i++) {\n    var obj = objects_1[_i];\n    if (!obj[key]) continue;\n\n    if (obj[key].amount != undefined) {\n      // if its a quote, it has .amount\n      amount = ethers_1.ethers.BigNumber.from(obj[key].amount);\n    } else {\n      // if its an order, it has .data\n      amount = ethers_1.ethers.BigNumber.from(obj[key].data.slice(0, 66));\n    }\n\n    if (!best || amount.lt(bestAmount)) {\n      bestAmount = amount;\n      best = obj;\n    }\n  }\n\n  return best;\n}\n\nfunction getHighest(objects, key) {\n  var best;\n  var bestAmount;\n  var amount;\n\n  for (var _i = 0, objects_2 = objects; _i < objects_2.length; _i++) {\n    var obj = objects_2[_i];\n    if (!obj[key]) continue;\n\n    if (obj[key].amount != undefined) {\n      // if its a quote, it has .amount\n      amount = ethers_1.ethers.BigNumber.from(obj[key].amount);\n    } else {\n      // if its an order, it has .data\n      amount = ethers_1.ethers.BigNumber.from(obj[key].data.slice(0, 66));\n    }\n\n    if (!best || amount.gt(bestAmount)) {\n      bestAmount = amount;\n      best = obj;\n    }\n  }\n\n  return best;\n}\n\nfunction getBestByLowestSenderAmount(objects) {\n  return getLowest(objects, 'sender');\n}\n\nexports.getBestByLowestSenderAmount = getBestByLowestSenderAmount;\n\nfunction getBestByLowestSignerAmount(objects) {\n  return getLowest(objects, 'signer');\n}\n\nexports.getBestByLowestSignerAmount = getBestByLowestSignerAmount;\n\nfunction getBestByHighestSignerAmount(objects) {\n  return getHighest(objects, 'signer');\n}\n\nexports.getBestByHighestSignerAmount = getBestByHighestSignerAmount;\n\nfunction getBestByHighestSenderAmount(objects) {\n  return getHighest(objects, 'sender');\n}\n\nexports.getBestByHighestSenderAmount = getBestByHighestSenderAmount;\n\nfunction toDecimalString(value, decimals) {\n  return ethers_1.ethers.utils.formatUnits(value.toString(), decimals).toString();\n}\n\nexports.toDecimalString = toDecimalString;\n\nfunction toAtomicString(value, decimals) {\n  return ethers_1.ethers.utils.parseUnits(value.toString(), decimals).toString();\n}\n\nexports.toAtomicString = toAtomicString;\n\nfunction getTimestamp() {\n  return Math.round(Date.now() / 1000).toString();\n}\n\nexports.getTimestamp = getTimestamp;\n\nfunction parseUrl(locator) {\n  if (!/(http|ws)s?:\\/\\//.test(locator)) {\n    locator = \"https://\" + locator;\n  }\n\n  return url.parse(locator);\n}\n\nexports.parseUrl = parseUrl;\n\nfunction getEtherscanURL(chainId, hash) {\n  return \"https://\" + constants_1.etherscanDomains[chainId] + \"/tx/\" + hash;\n}\n\nexports.getEtherscanURL = getEtherscanURL;\n\nfunction flattenObject(obj, propName, result) {\n  if (propName === void 0) {\n    propName = '';\n  }\n\n  if (result === void 0) {\n    result = {};\n  }\n\n  if (Object(obj) !== obj) {\n    result[propName] = obj;\n  } else {\n    for (var prop in obj) {\n      flattenObject(obj[prop], propName ? propName + prop.charAt(0).toUpperCase() + prop.slice(1) : prop, result);\n    }\n  }\n\n  return result;\n}\n\nexports.flattenObject = flattenObject;\n\nfunction lowerCaseAddresses(obj) {\n  for (var key in obj) {\n    if (typeof obj[key] === 'object') {\n      lowerCaseAddresses(obj[key]);\n    } else if (typeof obj[key] === 'string' && obj[key].indexOf('0x') === 0) {\n      obj[key] = obj[key].toLowerCase();\n    } else {\n      obj[key] = obj[key].toString();\n    }\n  }\n\n  return obj;\n}\n\nexports.lowerCaseAddresses = lowerCaseAddresses;","map":{"version":3,"sources":["../index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.lowerCaseAddresses = exports.flattenObject = exports.getEtherscanURL = exports.parseUrl = exports.getTimestamp = exports.toAtomicString = exports.toDecimalString = exports.getBestByHighestSenderAmount = exports.getBestByHighestSignerAmount = exports.getBestByLowestSignerAmount = exports.getBestByLowestSenderAmount = exports.calculateCostFromLevels = exports.calculateCost = void 0;\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nvar ethers_1 = require(\"ethers\");\nvar url = __importStar(require(\"url\"));\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nvar constants_1 = require(\"@airswap/constants\");\n__exportStar(require(\"./src/hashes\"), exports);\n__exportStar(require(\"./src/orders\"), exports);\n__exportStar(require(\"./src/quotes\"), exports);\nfunction calculateCost(amount, pricing) {\n    // TODO: Formula support\n    if (typeof pricing !== 'string') {\n        return calculateCostFromLevels(amount, pricing);\n    }\n    return null;\n}\nexports.calculateCost = calculateCost;\nfunction calculateCostFromLevels(amount, levels) {\n    var totalAmount = new bignumber_js_1.default(amount);\n    var totalAvailable = new bignumber_js_1.default(levels[levels.length - 1][0]);\n    var totalCost = new bignumber_js_1.default(0);\n    var previousLevel = new bignumber_js_1.default(0);\n    if (totalAmount.gt(totalAvailable)) {\n        throw new Error(\"Requested amount (\" + totalAmount.toFixed() + \") exceeds maximum available (\" + totalAvailable.toFixed() + \").\");\n    }\n    // Steps through levels and multiplies each incremental amount by the level price\n    // Levels takes the form of [[ level, price ], ... ] as in [[ '100', '0.5' ], ... ]\n    for (var i = 0; i < levels.length; i++) {\n        var incrementalAmount = void 0;\n        if (totalAmount.gt(new bignumber_js_1.default(levels[i][0]))) {\n            incrementalAmount = new bignumber_js_1.default(levels[i][0]).minus(previousLevel);\n        }\n        else {\n            incrementalAmount = new bignumber_js_1.default(totalAmount).minus(previousLevel);\n        }\n        totalCost = totalCost.plus(new bignumber_js_1.default(incrementalAmount).multipliedBy(levels[i][1]));\n        previousLevel = new bignumber_js_1.default(levels[i][0]);\n        if (totalAmount.lt(previousLevel))\n            break;\n    }\n    return totalCost.decimalPlaces(6).toFixed();\n}\nexports.calculateCostFromLevels = calculateCostFromLevels;\nfunction getLowest(objects, key) {\n    var best;\n    var bestAmount;\n    var amount;\n    for (var _i = 0, objects_1 = objects; _i < objects_1.length; _i++) {\n        var obj = objects_1[_i];\n        if (!obj[key])\n            continue;\n        if (obj[key].amount != undefined) {\n            // if its a quote, it has .amount\n            amount = ethers_1.ethers.BigNumber.from(obj[key].amount);\n        }\n        else {\n            // if its an order, it has .data\n            amount = ethers_1.ethers.BigNumber.from(obj[key].data.slice(0, 66));\n        }\n        if (!best || amount.lt(bestAmount)) {\n            bestAmount = amount;\n            best = obj;\n        }\n    }\n    return best;\n}\nfunction getHighest(objects, key) {\n    var best;\n    var bestAmount;\n    var amount;\n    for (var _i = 0, objects_2 = objects; _i < objects_2.length; _i++) {\n        var obj = objects_2[_i];\n        if (!obj[key])\n            continue;\n        if (obj[key].amount != undefined) {\n            // if its a quote, it has .amount\n            amount = ethers_1.ethers.BigNumber.from(obj[key].amount);\n        }\n        else {\n            // if its an order, it has .data\n            amount = ethers_1.ethers.BigNumber.from(obj[key].data.slice(0, 66));\n        }\n        if (!best || amount.gt(bestAmount)) {\n            bestAmount = amount;\n            best = obj;\n        }\n    }\n    return best;\n}\nfunction getBestByLowestSenderAmount(objects) {\n    return getLowest(objects, 'sender');\n}\nexports.getBestByLowestSenderAmount = getBestByLowestSenderAmount;\nfunction getBestByLowestSignerAmount(objects) {\n    return getLowest(objects, 'signer');\n}\nexports.getBestByLowestSignerAmount = getBestByLowestSignerAmount;\nfunction getBestByHighestSignerAmount(objects) {\n    return getHighest(objects, 'signer');\n}\nexports.getBestByHighestSignerAmount = getBestByHighestSignerAmount;\nfunction getBestByHighestSenderAmount(objects) {\n    return getHighest(objects, 'sender');\n}\nexports.getBestByHighestSenderAmount = getBestByHighestSenderAmount;\nfunction toDecimalString(value, decimals) {\n    return ethers_1.ethers.utils.formatUnits(value.toString(), decimals).toString();\n}\nexports.toDecimalString = toDecimalString;\nfunction toAtomicString(value, decimals) {\n    return ethers_1.ethers.utils.parseUnits(value.toString(), decimals).toString();\n}\nexports.toAtomicString = toAtomicString;\nfunction getTimestamp() {\n    return Math.round(Date.now() / 1000).toString();\n}\nexports.getTimestamp = getTimestamp;\nfunction parseUrl(locator) {\n    if (!/(http|ws)s?:\\/\\//.test(locator)) {\n        locator = \"https://\" + locator;\n    }\n    return url.parse(locator);\n}\nexports.parseUrl = parseUrl;\nfunction getEtherscanURL(chainId, hash) {\n    return \"https://\" + constants_1.etherscanDomains[chainId] + \"/tx/\" + hash;\n}\nexports.getEtherscanURL = getEtherscanURL;\nfunction flattenObject(obj, propName, result) {\n    if (propName === void 0) { propName = ''; }\n    if (result === void 0) { result = {}; }\n    if (Object(obj) !== obj) {\n        result[propName] = obj;\n    }\n    else {\n        for (var prop in obj) {\n            flattenObject(obj[prop], propName\n                ? propName + prop.charAt(0).toUpperCase() + prop.slice(1)\n                : prop, result);\n        }\n    }\n    return result;\n}\nexports.flattenObject = flattenObject;\nfunction lowerCaseAddresses(obj) {\n    for (var key in obj) {\n        if (typeof obj[key] === 'object') {\n            lowerCaseAddresses(obj[key]);\n        }\n        else if (typeof obj[key] === 'string' && obj[key].indexOf('0x') === 0) {\n            obj[key] = obj[key].toLowerCase();\n        }\n        else {\n            obj[key] = obj[key].toString();\n        }\n    }\n    return obj;\n}\nexports.lowerCaseAddresses = lowerCaseAddresses;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}